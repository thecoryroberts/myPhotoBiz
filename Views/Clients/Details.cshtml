@using MyPhotoBiz.Models
@model MyPhotoBiz.ViewModels.ClientDetailsViewModel
@{
    ViewBag.Title = $"{Model.FirstName} {Model.LastName}";
    ViewBag.Purpose = "View client details.";
    ViewBag.PageTitle = "Client Details";
    ViewBag.SubTitle = "Clients";
    ViewBag.SubTitleUrl = Url.Action("Index", "Clients");
    ViewBag.Icon = "ti-user";
    ViewBag.Color = "primary";
    var initials = MyPhotoBiz.Helpers.ViewHelper.GetInitials(Model.FirstName, Model.LastName);
    var avatarUrl = Model.User?.ProfilePicture;
}

<div class="container-fluid">
    <partial name="Partials/_PageTitle" />

    <div class="row">
        <div class="col-12">
            <article class="card card-out-of-container border-top-0">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex justify-content-start align-items-center gap-3">
                            <div class="avatar avatar-xxl">
                                @if (!string.IsNullOrEmpty(avatarUrl))
                                {
                                    <img src="@Url.Content(avatarUrl)" alt="Profile" class="img-fluid img-thumbnail rounded-circle">
                                }
                                else
                                {
                                    <span class="avatar-title bg-primary-subtle text-primary rounded-circle fs-1">
                                        @initials
                                    </span>
                                }
                            </div>
                            <div>
                                <h4 class="text-nowrap fw-bold mb-1">@Model.FirstName @Model.LastName</h4>
                                <p class="text-muted mb-1">@Model.Email</p>
                                <span class="badge bg-success-subtle text-success fw-medium fs-xs">
                                    <i class="ti ti-user-check me-1"></i>Client
                                </span>
                            </div>
                        </div>
                        <div class="d-flex gap-2">
                            <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">
                                <i class="ti ti-edit me-1"></i>Edit Client
                            </a>
                            <a asp-action="Index" class="btn btn-light">
                                <i class="ti ti-arrow-left me-1"></i>Back to List
                            </a>
                        </div>
                    </div>
                </div>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-xxl-10">
            <div class="row">
                <!-- Sidebar -->
            <!-- Contact Information -->
                <div class="col-xl-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0 d-flex align-items-center gap-2">
                            <i class="ti ti-address-book fs-lg text-primary"></i>
                            Contact Information
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex align-items-center gap-2 mb-3">
                                <div class="avatar-sm bg-light d-flex align-items-center justify-content-center rounded">
                                    <i class="ti ti-user fs-xl text-secondary"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="text-muted small">Full Name</div>
                                    <div class="fw-semibold">@Model.FirstName @Model.LastName</div>
                                </div>
                            </div>

                            <div class="d-flex align-items-center gap-2 mb-3">
                                <div class="avatar-sm bg-light d-flex align-items-center justify-content-center rounded">
                                    <i class="ti ti-mail fs-xl text-secondary"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="text-muted small">Email Address</div>
                                    <div class="fw-semibold">@Model.Email</div>
                                </div>
                            </div>

                            <div class="d-flex align-items-center gap-2 mb-3">
                                <div class="avatar-sm bg-light d-flex align-items-center justify-content-center rounded">
                                    <i class="ti ti-phone fs-xl text-secondary"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="text-muted small">Phone Number</div>
                                    <div class="fw-semibold">@(Model.PhoneNumber ?? "Not provided")</div>
                                </div>
                            </div>

                            @if (!string.IsNullOrWhiteSpace(Model.Address))
                            {
                                <div class="d-flex align-items-center gap-2 mb-3">
                                    <div class="avatar-sm bg-light d-flex align-items-center justify-content-center rounded">
                                        <i class="ti ti-map-pin fs-xl text-secondary"></i>
                                    </div>
                                    <div class="flex-grow-1">
                                        <div class="text-muted small">Address</div>
                                        <div class="fw-semibold">@Model.Address</div>
                                    </div>
                                </div>
                            }

                            <div class="d-flex align-items-center gap-2">
                                <div class="avatar-sm bg-light d-flex align-items-center justify-content-center rounded">
                                    <i class="ti ti-calendar fs-xl text-secondary"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="text-muted small">Client Since</div>
                                    <div class="fw-semibold">@Model.CreatedDate.ToString("MMMM yyyy")</div>
                                </div>
                            </div>
                        </div>
                    </div>                   
                    <!-- Quick Actions -->
                    <div class="card">
                      <div class="card-header">
                            <h5 class="card-title mb-0 d-flex align-items-center gap-2">
                            <i class="ti ti-bolt fs-lg text-primary"></i>
                            Quick Actions
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="d-flex flex-column gap-2">
                                <a asp-controller="PhotoShoots" asp-action="Create" asp-route-clientId="@Model.Id"
                                    class="btn btn-success">
                                    <i class="ti ti-camera me-1"></i> Schedule Photo Shoot
                                </a>
                                <a asp-controller="Contracts" asp-action="Create" asp-route-clientId="@Model.Id"
                                    class="btn btn-info">
                                    <i class="ti ti-file-text me-1"></i> Create Contract
                                </a>
                                <a asp-controller="Invoices" asp-action="Create" asp-route-clientId="@Model.Id"
                                    class="btn btn-primary">
                                    <i class="ti ti-file-invoice me-1"></i> Create Invoice
                                </a>
                                <a href="mailto:@Model.Email" class="btn btn-light">
                                    <i class="ti ti-mail me-1"></i> Send Email
                                </a>
                                @if (!string.IsNullOrEmpty(Model.PhoneNumber))
                                {
                                    <a href="tel:@Model.PhoneNumber" class="btn btn-light">
                                        <i class="ti ti-phone me-1"></i> Call Client
                                    </a>
                                }
                                <hr class="my-2">
                                <a asp-action="Delete" asp-route-id="@Model.Id"
                                    class="btn btn-outline-danger delete-client-btn"
                                    data-client-name="@Model.FirstName @Model.LastName">
                                    <i class="ti ti-trash me-1"></i> Delete Client
                                </a>
                            </div>
                        </div>
                    </div>
                     <!-- Notes Section -->
                    @if (!string.IsNullOrWhiteSpace(Model.Notes))
                    {
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0 d-flex align-items-center gap-2">
                                <i class="ti ti-notes fs-lg text-primary"></i>
                                Notes
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="bg-light p-3 rounded">
                                    <p class="mb-0">@Model.Notes</p>
                                </div>
                            </div>
                        </div>
                    }
                
                </div>

                <!-- Main Content Area -->
                <div class="col-xl-8">
                    <div class="card">
                        <div class="card-header border-light">
                            <ul class="nav nav-pills card-header-pills" id="client-details-tabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="client-overview-tab" data-bs-toggle="tab" data-bs-target="#client-overview" type="button" role="tab" aria-controls="client-overview" aria-selected="true">
                                        <i class="ti ti-layout-dashboard me-1"></i>Overview
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="client-account-tab" data-bs-toggle="tab" data-bs-target="#client-account" type="button" role="tab" aria-controls="client-account" aria-selected="false">
                                        <i class="ti ti-user-circle me-1"></i>Account
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="client-badges-tab" data-bs-toggle="tab" data-bs-target="#client-badges" type="button" role="tab" aria-controls="client-badges" aria-selected="false">
                                        <i class="ti ti-award me-1"></i>Badges
                                    </button>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body">
                            <div class="tab-content">
                                <div class="tab-pane fade show active" id="client-overview" role="tabpanel" aria-labelledby="client-overview-tab">
                                    <div class="row g-3 mb-3">
                                        <div class="col-md-3">
                                            <div class="card text-center">
                                                <div class="card-body py-3">
                                                    <div class="avatar avatar-lg bg-primary-subtle mb-2 mx-auto">
                                                        <span class="avatar-title text-primary rounded-circle">
                                                            <i class="ti ti-camera fs-1"></i>
                                                        </span>
                                                    </div>
                                                    <div class="text-muted small">Photo Shoots</div>
                                                    <div class="h4 mt-1 mb-0">@(Model.PhotoShoots?.Count ?? 0)</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="card text-center">
                                                <div class="card-body py-3">
                                                    <div class="avatar avatar-lg bg-warning-subtle mb-2 mx-auto">
                                                        <span class="avatar-title text-warning rounded-circle">
                                                            <i class="ti ti-file-text fs-1"></i>
                                                        </span>
                                                    </div>
                                                    <div class="text-muted small">Contracts</div>
                                                    <div class="h4 mt-1 mb-0">@(Model.Contracts?.Count ?? 0)</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="card text-center">
                                                <div class="card-body py-3">
                                                    <div class="avatar avatar-lg bg-info-subtle mb-2 mx-auto">
                                                        <span class="avatar-title text-info rounded-circle">
                                                            <i class="ti ti-file-invoice fs-1"></i>
                                                        </span>
                                                    </div>
                                                    <div class="text-muted small">Invoices</div>
                                                    <div class="h4 mt-1 mb-0">@(Model.Invoices?.Count ?? 0)</div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-3">
                                            <div class="card text-center">
                                                <div class="card-body py-3">
                                                    <div class="avatar avatar-lg bg-success-subtle mb-2 mx-auto">
                                                        <span class="avatar-title text-success rounded-circle">
                                                            <i class="ti ti-cash fs-1"></i>
                                                        </span>
                                                    </div>
                                                    <div class="text-muted small">Total Revenue</div>
                                                    <div class="h4 mt-1 mb-0 text-success">@((Model.Invoices?.Sum(i => i.Amount + i.Tax) ?? 0).ToString("C"))</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    @if (Model.PhotoShoots != null && Model.PhotoShoots.Any())
                                    {
                                        <div class="card mb-3">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0 d-flex align-items-center gap-2">
                                                    <i class="ti ti-camera fs-lg text-primary"></i>
                                                    Photo Shoots
                                                </h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-hover align-middle mb-0">
                                                        <thead class="bg-light bg-opacity-25">
                                                            <tr class="text-uppercase fs-xxs">
                                                                <th>Title</th>
                                                                <th>Date</th>
                                                                <th>Location</th>
                                                                <th>Status</th>
                                                                <th class="text-center">Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            @foreach (var shoot in Model.PhotoShoots.OrderByDescending(s => s.ScheduledDate))
                                                            {
                                                                <tr>
                                                                    <td>
                                                                        <strong>@shoot.Title</strong>
                                                                    </td>
                                                                    <td>@shoot.ScheduledDate.ToString("MMM dd, yyyy")</td>
                                                                    <td>@(shoot.Location ?? "N/A")</td>
                                                                    <td>
                                                                        @switch (shoot.Status)
                                                                        {
                                                                            case PhotoShootStatus.Scheduled:
                                                                                <span class="badge bg-info-subtle text-info">Scheduled</span>
                                                                                break;
                                                                            case PhotoShootStatus.Completed:
                                                                                <span class="badge bg-success-subtle text-success">Completed</span>
                                                                                break;
                                                                            case PhotoShootStatus.Cancelled:
                                                                                <span class="badge bg-danger-subtle text-danger">Cancelled</span>
                                                                                break;
                                                                            case PhotoShootStatus.InProgress:
                                                                            default:
                                                                                <span class="badge bg-warning-subtle text-warning">Pending</span>
                                                                                break;
                                                                        }
                                                                    </td>
                                                                    <td class="text-center">
                                                                        <a asp-controller="PhotoShoots" asp-action="Details"
                                                                            asp-route-id="@shoot.Id"
                                                                            class="btn btn-sm btn-outline-secondary btn-icon">
                                                                            <i class="ti ti-eye"></i>
                                                                        </a>
                                                                    </td>
                                                                </tr>
                                                            }
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    }

                                    @if (Model.Invoices != null && Model.Invoices.Any())
                                    {
                                        <div class="card mb-3">
                                            <div class="card-header">
                                                <h5 class="card-title mb-0 d-flex align-items-center gap-2">
                                                    <i class="ti ti-file-invoice fs-lg text-primary"></i>
                                                    Invoices
                                                </h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-hover align-middle mb-0">
                                                        <thead class="bg-light bg-opacity-25">
                                                            <tr class="text-uppercase fs-xxs">
                                                                <th>Invoice #</th>
                                                                <th>Date</th>
                                                                <th>Due Date</th>
                                                                <th>Amount</th>
                                                                <th>Status</th>
                                                                <th class="text-center">Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            @foreach (var invoice in Model.Invoices.OrderByDescending(i => i.InvoiceDate))
                                                            {
                                                                <tr>
                                                                    <td><strong>@invoice.InvoiceNumber</strong></td>
                                                                    <td>@invoice.InvoiceDate.ToString("MMM dd, yyyy")</td>
                                                                    <td>@invoice.DueDate.ToString("MMM dd, yyyy")</td>
                                                                    <td><strong>@((invoice.Amount + invoice.Tax).ToString("C"))</strong></td>
                                                                    <td>
                                                                        @switch (invoice.Status.ToString())
                                                                        {
                                                                            case "Paid":
                                                                                <span class="badge bg-success-subtle text-success">Paid</span>
                                                                                break;
                                                                            case "Overdue":
                                                                                <span class="badge bg-danger-subtle text-danger">Overdue</span>
                                                                                break;
                                                                            case "Pending":
                                                                                <span class="badge bg-warning-subtle text-warning">Pending</span>
                                                                                break;
                                                                            default:
                                                                                <span class="badge bg-info-subtle text-info">@invoice.Status</span>
                                                                                break;
                                                                        }
                                                                    </td>
                                                                    <td class="text-center">
                                                                        <a asp-controller="Invoices" asp-action="Details"
                                                                            asp-route-id="@invoice.Id"
                                                                            class="btn btn-sm btn-outline-secondary btn-icon">
                                                                            <i class="ti ti-eye"></i>
                                                                        </a>
                                                                    </td>
                                                                </tr>
                                                            }
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    }

                                    @if (Model.Contracts != null && Model.Contracts.Any())
                                    {
                                        <div class="card mb-0">
                                            <div class="card-header d-flex justify-content-between align-items-center">
                                                <h5 class="card-title mb-0">
                                                    <i class="ti ti-file-text me-2"></i>Contracts
                                                </h5>
                                                <a asp-controller="Contracts" asp-action="Create" asp-route-clientId="@Model.Id" class="btn btn-sm btn-primary">
                                                    <i class="ti ti-plus me-1"></i> New Contract
                                                </a>
                                            </div>
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table table-hover align-middle mb-0">
                                                        <thead class="bg-light bg-opacity-25">
                                                            <tr class="text-uppercase fs-xxs">
                                                                <th>Title</th>
                                                                <th>Created</th>
                                                                <th>Status</th>
                                                                <th>Signed Date</th>
                                                                <th class="text-center">Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            @foreach (var contract in Model.Contracts.OrderByDescending(c => c.CreatedDate))
                                                            {
                                                                <tr>
                                                                    <td>
                                                                        <strong>@contract.Title</strong>
                                                                        @if (contract.AwardBadgeOnSign)
                                                                        {
                                                                            <span class="badge bg-warning-subtle text-warning ms-2" title="Awards badge on signing">
                                                                                <i class="ti ti-award"></i>
                                                                            </span>
                                                                        }
                                                                    </td>
                                                                    <td>@contract.CreatedDate.ToString("MMM dd, yyyy")</td>
                                                                    <td>
                                                                        @switch (contract.Status)
                                                                        {
                                                                            case MyPhotoBiz.Enums.ContractStatus.Draft:
                                                                                <span class="badge bg-secondary-subtle text-secondary">Draft</span>
                                                                                break;
                                                                            case MyPhotoBiz.Enums.ContractStatus.PendingSignature:
                                                                                <span class="badge bg-warning-subtle text-warning">Pending Signature</span>
                                                                                break;
                                                                            case MyPhotoBiz.Enums.ContractStatus.Signed:
                                                                                <span class="badge bg-success-subtle text-success">
                                                                                    <i class="ti ti-check me-1"></i>Signed
                                                                                </span>
                                                                                break;
                                                                            case MyPhotoBiz.Enums.ContractStatus.Expired:
                                                                                <span class="badge bg-danger-subtle text-danger">Expired</span>
                                                                                break;
                                                                            default:
                                                                                <span class="badge bg-info-subtle text-info">@contract.Status</span>
                                                                                break;
                                                                        }
                                                                    </td>
                                                                    <td>
                                                                        @if (contract.SignedDate.HasValue)
                                                                        {
                                                                            @contract.SignedDate.Value.ToString("MMM dd, yyyy")
                                                                        }
                                                                        else
                                                                        {
                                                                            <span class="text-muted">—</span>
                                                                        }
                                                                    </td>
                                                                    <td class="text-center">
                                                                        <div class="btn-group" role="group">
                                                                            <a asp-controller="Contracts" asp-action="Details"
                                                                                asp-route-id="@contract.Id"
                                                                                class="btn btn-sm btn-outline-secondary btn-icon"
                                                                                title="View Details">
                                                                                <i class="ti ti-eye"></i>
                                                                            </a>
                                                                            @if (contract.Status == MyPhotoBiz.Enums.ContractStatus.Draft)
                                                                            {
                                                                                <a asp-controller="Contracts" asp-action="Edit"
                                                                                    asp-route-id="@contract.Id"
                                                                                    class="btn btn-sm btn-outline-secondary btn-icon"
                                                                                    title="Edit">
                                                                                    <i class="ti ti-edit"></i>
                                                                                </a>
                                                                            }
                                                                            @if (!string.IsNullOrEmpty(contract.PdfFilePath))
                                                                            {
                                                                                <a href="@contract.PdfFilePath" target="_blank"
                                                                                    class="btn btn-sm btn-outline-secondary btn-icon"
                                                                                    title="View PDF">
                                                                                    <i class="ti ti-file-download"></i>
                                                                                </a>
                                                                            }
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            }
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="card mb-0">
                                            <div class="card-body text-center py-5">
                                                <i class="ti ti-file-text" style="font-size: 48px; color: #ccc;"></i>
                                                <p class="text-muted mt-3 mb-3">No contracts found for this client.</p>
                                                <a asp-controller="Contracts" asp-action="Create" asp-route-clientId="@Model.Id" class="btn btn-primary">
                                                    <i class="ti ti-plus me-1"></i> Create First Contract
                                                </a>
                                            </div>
                                        </div>
                                    }
                                </div>

                                <div class="tab-pane fade" id="client-account" role="tabpanel" aria-labelledby="client-account-tab">
                                    @{
                                        var userStatus = Model.User?.LockoutEnd.HasValue == true && Model.User.LockoutEnd.Value > DateTimeOffset.UtcNow
                                            ? "Locked"
                                            : Model.User?.EmailConfirmed == true ? "Active" : "Pending";
                                        var userStatusBadge = userStatus switch
                                        {
                                            "Active" => "bg-success-subtle text-success",
                                            "Locked" => "bg-danger-subtle text-danger",
                                            "Pending" => "bg-warning-subtle text-warning",
                                            _ => "bg-secondary-subtle text-secondary"
                                        };
                                        var userStatusIcon = userStatus switch
                                        {
                                            "Active" => "ti-check",
                                            "Locked" => "ti-lock",
                                            "Pending" => "ti-clock",
                                            _ => "ti-help"
                                        };
                                        var userIdShort = Model.User?.Id != null
                                            ? Model.User.Id.Substring(0, Math.Min(8, Model.User.Id.Length))
                                            : "—";
                                        var userCreatedDate = Model.User != null
                                            ? Model.User.CreatedDate.ToString("MMM dd, yyyy")
                                            : "—";
                                        var userType = Model.User != null ? Model.User.UserType.ToString() : "—";
                                    }

                                    <div class="border rounded p-3 mb-3">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <h6 class="mb-0 fw-semibold">
                                                <i class="ti ti-user me-2"></i>User Account
                                            </h6>
                                            <span class="badge @userStatusBadge">
                                                <i class="ti @userStatusIcon me-1"></i>@userStatus
                                            </span>
                                        </div>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="text-muted small">User ID</div>
                                                <div class="fw-semibold">#USR@userIdShort</div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="text-muted small">User Type</div>
                                                <div class="fw-semibold">@userType</div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="text-muted small">Email Confirmed</div>
                                                @if (Model.User?.EmailConfirmed == true)
                                                {
                                                    <span class="badge bg-success-subtle text-success">
                                                        <i class="ti ti-check me-1"></i>Verified
                                                    </span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-warning-subtle text-warning">
                                                        <i class="ti ti-x me-1"></i>Not Verified
                                                    </span>
                                                }
                                            </div>
                                            <div class="col-md-6">
                                                <div class="text-muted small">Phone Confirmed</div>
                                                @if (Model.User?.PhoneNumberConfirmed == true)
                                                {
                                                    <span class="badge bg-success-subtle text-success">
                                                        <i class="ti ti-check me-1"></i>Verified
                                                    </span>
                                                }
                                                else
                                                {
                                                    <span class="badge bg-secondary-subtle text-secondary">
                                                        <i class="ti ti-x me-1"></i>Not Verified
                                                    </span>
                                                }
                                            </div>
                                            <div class="col-md-6">
                                                <div class="text-muted small">Account Created</div>
                                                <div class="fw-semibold">@userCreatedDate</div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="text-muted small">Two-Factor Enabled</div>
                                                <div class="fw-semibold">@(Model.User?.TwoFactorEnabled == true ? "Yes" : "No")</div>
                                            </div>
                                        </div>
                                    </div>

                                    @if (Model.User?.LockoutEnd.HasValue == true && Model.User.LockoutEnd.Value > DateTimeOffset.UtcNow)
                                    {
                                        <div class="alert alert-danger d-flex align-items-center" role="alert">
                                            <i class="ti ti-lock fs-xl me-2"></i>
                                            <div>
                                                <strong>Account Locked</strong>
                                                <div class="small">Until @Model.User.LockoutEnd.Value.ToString("MMMM dd, yyyy hh:mm tt")</div>
                                            </div>
                                        </div>
                                    }
                                </div>

                                <div class="tab-pane fade" id="client-badges" role="tabpanel" aria-labelledby="client-badges-tab">
                                    <div class="card">
                                        <div class="card-header">
                                            <h5 class="card-title mb-0 d-flex align-items-center gap-2">
                                                <i class="ti ti-award me-2 fs-lg text-primary"></i>
                                                Badges Earned
                                            </h5>
                                        </div>
                                        <div class="card-body">
                                            <partial name="_ClientBadges" model="@Model.ClientBadges" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

@section scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Handle delete client confirmation
            document.querySelector('.delete-client-btn')?.addEventListener('click', function(e) {
                e.preventDefault();
                var clientName = this.getAttribute('data-client-name');
                var href = this.href;

                confirmAction({
                    title: 'Delete Client?',
                    text: 'Are you sure you want to delete ' + clientName + '? This will permanently remove all associated data including photo shoots and invoices.',
                    icon: 'warning',
                    confirmButtonColor: '#d33',
                    confirmButtonText: 'Yes, delete client'
                }).then(function(result) {
                    if (result.isConfirmed) {
                        window.location.href = href;
                    }
                });
            });
        });
    </script>
}
