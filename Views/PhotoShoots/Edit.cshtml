@using MyPhotoBiz.ViewModels
@model PhotoShootViewModel

@{
    ViewBag.Title = "Edit";
    ViewBag.PageTitle = "Edit Photo Shoot";
    ViewBag.SubTitle = "Photo Shoots";
    ViewBag.SubTitleUrl = Url.Action("Index", "PhotoShoots");
    ViewBag.Icon = "ti-camera-cog";
    ViewBag.Color = "warning";
    ViewBag.BackUrl = Url.Action("Index", "PhotoShoots");
    ViewBag.Purpose = "Edit photo shoot.";
}

<div class="container-fluid">
    <partial name="Partials/_PageTitle" />

    <div class="row justify-content-center">
        <div class="col-xxl-10">
            <div class="row">
                <div class="col-xl-9">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="card-title">Edit Photo Shoot</h4>
                        </div>
                        <div class="card-body">
                            <form asp-action="Edit" method="post" id="editPhotoShootForm">
                                @Html.AntiForgeryToken()
                                <input type="hidden" asp-for="Id" />

                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="mb-3">
                                            <label asp-for="Title" class="form-label">
                                                Shoot Title <span class="text-danger">*</span>
                                            </label>
                                            <input asp-for="Title" class="form-control" placeholder="e.g., Smith Wedding, Johnson Family Portrait" />
                                            <span asp-validation-for="Title" class="text-danger"></span>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="mb-3">
                                            <label asp-for="Status" class="form-label">
                                                Status <span class="text-danger">*</span>
                                            </label>
                                            <select asp-for="Status" class="form-select">
                                                <option value="Scheduled">Scheduled</option>
                                                <option value="InProgress">In Progress</option>
                                                <option value="Completed">Completed</option>
                                                <option value="Cancelled">Cancelled</option>
                                            </select>
                                            <span asp-validation-for="Status" class="text-danger"></span>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="ClientId" class="form-label">
                                        Client <span class="text-danger">*</span>
                                    </label>
                                    <select asp-for="ClientId" asp-items="Model.Clients" class="form-select">
                                        <option value="">Select a client...</option>
                                    </select>
                                    <span asp-validation-for="ClientId" class="text-danger"></span>
                                    <small class="text-muted">Select the client for this photo shoot</small>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label asp-for="ScheduledDate" class="form-label">
                                                Start Date & Time <span class="text-danger">*</span>
                                            </label>
                                            <input asp-for="ScheduledDate" type="datetime-local" class="form-control" id="scheduledDate" />
                                            <span asp-validation-for="ScheduledDate" class="text-danger"></span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label asp-for="EndTime" class="form-label">
                                                End Date & Time
                                            </label>
                                            <input asp-for="EndTime" type="datetime-local" class="form-control" />
                                            <span asp-validation-for="EndTime" class="text-danger"></span>
                                            <small class="text-muted">Leave blank if duration is unknown</small>
                                        </div>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="Location" class="form-label">
                                        Location <span class="text-danger">*</span>
                                    </label>
                                    <input asp-for="Location" class="form-control" placeholder="e.g., 123 Main St, City Park, Studio A" />
                                    <span asp-validation-for="Location" class="text-danger"></span>
                                    <small class="text-muted">Address or venue name where the shoot will take place</small>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="Price" class="form-label">
                                        Price ($)
                                    </label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input asp-for="Price" type="number" step="0.01" min="0" class="form-control" placeholder="0.00" />
                                    </div>
                                    <span asp-validation-for="Price" class="text-danger"></span>
                                    <small class="text-muted">Total price for this shoot</small>
                                </div>

                                <div class="mb-3">
                                    <label asp-for="Notes" class="form-label">
                                        Notes
                                    </label>
                                    <textarea asp-for="Notes" rows="4" class="form-control" placeholder="Special instructions, equipment needed, client preferences..."></textarea>
                                    <span asp-validation-for="Notes" class="text-danger"></span>
                                </div>

                                <div class="d-flex gap-2 justify-content-end">
                                    <a asp-action="Index" class="btn btn-light">
                                        <i class="ti ti-arrow-left me-2"></i>Cancel
                                    </a>
                                    <button type="submit" class="btn btn-primary" id="submitBtn">
                                        <span class="btn-text">
                                            <i class="ti ti-check me-2"></i>Save Changes
                                        </span>
                                        <span class="btn-loading d-none">
                                            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                                            Saving...
                                        </span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        document.getElementById('editPhotoShootForm').addEventListener('submit', function(e) {
            const form = this;
            const submitBtn = document.getElementById('submitBtn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoading = submitBtn.querySelector('.btn-loading');

            // Check if form is valid before showing loading state
            if (form.checkValidity()) {
                submitBtn.disabled = true;
                btnText.classList.add('d-none');
                btnLoading.classList.remove('d-none');
            }
        });
    </script>
}
